% Define document class
\documentclass[twocolumn]{aastex631}
\usepackage{showyourwork}



\newcommand\aastex{AAS\TeX}
\newcommand\latex{La\TeX}

\newcommand{\kms}{\ensuremath{\,\rm{km}\,\rm{s}^{-1}}\xspace}
\newcommand{\Rsun}{\ensuremath{\,\rm{R_\odot}}}
\newcommand{\Msun}{\ensuremath{\rm{M}_{\odot}}\xspace}
\newcommand{\Zsun}{\ensuremath{\,\rm{Z}_{\rm \odot}}\xspace}
\newcommand{\Lsun}{\ensuremath{\,\rm{L}_{\rm \odot}}\xspace}
\newcommand{\kpc}{\ensuremath{\,\rm{kpc}}\xspace}
\newcommand{\yr}{\ensuremath{\,\rm{yr}}\xspace}
\newcommand{\Myr}{\ensuremath{\,\rm{Myr}}\xspace}
\newcommand{\Gyr}{\ensuremath{\,\rm{Gyr}}\xspace}
\newcommand{\Mpc}{\ensuremath{\,\rm{Gpc}}\xspace}
\newcommand{\Gpc}{\ensuremath{\,\rm{Gpc}}\xspace}
\newcommand{\cGpc}{\ensuremath{\,\rm{cGpc}}\xspace}

% Mass descriptions
\newcommand{\Mbh}{\ensuremath{\,M_{\rm BH}}\xspace}
\newcommand{\Mbheen}{\ensuremath{\,M_{\rm BH, 1}}\xspace}
\newcommand{\Mbhtwee}{\ensuremath{\,M_{\rm BH, 2}}\xspace}
\newcommand{\MZAMSI}{\ensuremath{M_{\rm ZAMS, 1}}\xspace}
\newcommand{\MZAMSII}{\ensuremath{M_{\rm ZAMS, 2}}\xspace}

\newcommand{\Mcore}{\ensuremath{M_{\rm core}}\xspace}
\newcommand{\dMsnI}{\ensuremath{dM_{\rm SN, 1}}\xspace}
\newcommand{\dMsnII}{\ensuremath{dM_{\rm SN, 2}}\xspace}

\newcommand{\Mco}{\ensuremath{\,M_{\rm CO}}\xspace}
\newcommand{\Mchirp}{\ensuremath{\,M_{\rm chirp}}\xspace}

% mass ratios
\newcommand{\qzams}{\ensuremath{q_{\mathrm{ZAMS}} }\xspace}
\newcommand{\qfinal}{\ensuremath{q_{\mathrm{final}} }\xspace}
\newcommand{\qBBH}{\ensuremath{q_{\mathrm{BBH}} }\xspace}

\newcommand{\fcore}{\ensuremath{f_{\mathrm{core}} }\xspace}

% SFRD prescriptions and rates
\newcommand{\tdelay}{\ensuremath{\,t_{\rm delay}}\xspace}

\newcommand{\SFRDzZ}{\ensuremath{\mathcal{S}(Z,z)}\xspace} 
\newcommand{\SFRDz}{\ensuremath{\mathrm{SFRD}(z)}\xspace} 
\newcommand{\dPdZ}{\ensuremath{\mathrm{\frac{dP}{dZ}}(Z,z)}\xspace}
\newcommand{\dpdZ}{\ensuremath{\mathrm{dP/dZ}(Z,z)}\xspace}

\newcommand{\RBBH}{\ensuremath{R_{\mathrm{BBH}}(z)}\xspace}

% Codes etc
\newcommand{\COMPAS}{{\tt COMPAS}\xspace}
\newcommand{\python}{{\tt python}\xspace}

\newcommand{\todo}[1]{{\color{purple}\bf{#1}}}
\newcommand{\SdM}[1]{{\color{pink}\bf{#1}}}

\usepackage{xspace}
\usepackage{cancel}
\usepackage{amsmath}






% Begin!
\begin{document}

% Title
\title{ A convenient, flexible and intuitive analytic expression for the metallicity-dependent cosmic star formation rate  }

% Author list

\correspondingauthor{L.~van Son}
\email{lieke.van.son@cfa.harvard.edu}

\author[0000-0001-5484-4987]{L.~A.~C.~van~Son}
\affiliation{Center for Astrophysics $|$ Harvard $\&$ Smithsonian,
60 Garden St., Cambridge, MA 02138, USA}
\affiliation{Anton Pannekoek Institute of Astronomy and GRAPPA, Science Park 904, University of Amsterdam, 1098XH Amsterdam, The Netherlands}
\affiliation{Max Planck Institute for Astrophysics, Karl-Schwarzschild-Str. 1, 85748 Garching, Germany}

 \author[0000-0001-9336-2825]{S. E. de Mink}
 \affiliation{Max Planck Institute for Astrophysics, Karl-Schwarzschild-Str. 1, 85748 Garching, Germany}
\affiliation{Anton Pannekoek Institute of Astronomy and GRAPPA, Science Park 904, University of Amsterdam, 1098XH Amsterdam, The Netherlands}
\affiliation{Center for Astrophysics $|$ Harvard $\&$ Smithsonian, 60 Garden St., Cambridge, MA 02138, USA}
% %%%%%

 \author[0000-0003-3308-2420]{R. Pakmor}
 \affiliation{Max Planck Institute for Astrophysics, Karl-Schwarzschild-Str. 1, 85748 Garching, Germany}

\author{et al?}

% Abstract with filler text
\begin{abstract}
New observational facilities are probing star formation and stellar transients and gravitational wave sources at ever increasing redshifts. Comparing these observations with predictions from model for stellar populations or the channels for the formation of gravitational wave sources require assumptions for the cosmic starformation rate density and, in particular, how this depends on metallicity.  Various approaches exist ranging from fully empirical prescriptions to prescriptions that are based on cosmological simulations. Both these approaches come with advantages and disadvantages and inherent uncertainties. 

To make it easier to produce model predictions we propose a simple analytical prescription that captures the main behavior of the advanced simulations. At the same time, the prescription comes with parameters that allow for variations in the overall shape and which can be easily interpreted. Our hope is that this expression provides a useful starting point for making predictions and comparison with observations. 
\end{abstract}

% Main body with filler text
\section{Introduction \label{sec: intro}}

%opening from Chruslinska & Nelemans. Crucially needed are simple prescriptions
% 2 ways in which we can tackle this: observationally or theoretically
% 3 problemen met waarnemingen: 1) high redshift cant see, 2) metallicity measurements 3) xx?
% Theoretical: issues with illustris 1, here we provide a simple  fit to 
% give zenodo + data
% dan een beetje science 
LIGO/Virgo are revealing double compact object mergers throughout the Universe. These systems originate from largely
% Er zijn allemaal BBH detecties, super leuk
% Om de rate te bedenken moeten we niet alleen numbe of meging BBH maar ook SFRD
% In dit paper geven we een nieuwe SFRD fit

% Er zijn vechillende manieren om een SFRD meer te geven 


% make 2D grid in z, Z, at each point: 
% What is delta  = |dModel-dTNG|?
% plot in 2d the delta

Since the delay time of BBHs can range from Myrs to multiple Gyrs, the birth environment of BBHs varies significantly and we cannot ignore the cosmological (metallicity) evolution of the Universe. 
The rate of Binary Black Hole (BBH) mergers at different redshifts depends both on the delay time distribution as well as the metallicity dependent star-formation rate density (\SFRDzZ).
The assumed cosmic star formation rate density (SFRD) will therefore greatly influence the observed rate of double compact object mergers \citep{Neijssel+2019, Chruslinska2019, Boco2020,Broekgaarden+2021a}. 
Moreover, it is the nuclear reactions in massive stars are responsible for the metal enrichment of the Universe at high redshift. The birth of massive stars, and their death as BHs are thus inseparable from the evolution of the metallicity distribution of the Universe. 

%%  metallicity density distribution %%
Merging BBHs are found to form more efficiently at low metallicities e.g. \citep[e.g.][]{BelczynskiVink2010, Stevenson+2017,Mapelli2017,Chruslinska2019_effectCO}. Therefore the assumed metallicity specific star formation rate will in particular have a large impact on the inferred merger rate \citep[e.g.][]{Chruslinska2019,Chruslinska2019_effectCO, Neijssel2019, Broekgaarden+2021a}.

It is difficult to observationally constrain the shape of the metallicity density distribution over redshift (see \cite{Chruslinska2019} for an extensive overview and discussion of relevant observational caveats). Traditionally the metallicity density distribution is estimated by combining a mass-metallicity relation (MZ-relation) and a galaxy stellar mass function (GSMF) \citep[see also][]{Chruslinska+2018, Chruslinska2019_effectCO, Broekgaarden+2021a}.
Another way is to extract the metallicity density fraction from cosmological simulations \citep[e.g.]{Mapelli2017, Schneider+2017}
Alternatively, one can combine an observed star formation rate, SFR(z), like from \cite{MadauDickinson2014} or \cite{Madau+2017}, and convolve this with some belief about the shape of the metallicity density distribution, such as was was done in \cite{Neijssel+2019}.
A third option is extract this information from cosmological simulations \citep[e.g.][]{Mapelli+2017,Schneider+2017}.
In this work we provide a new fit to the \SFRDzZ based on the TNG 100 simulation \citep{Pillepich2018, Weinberger2017}.

Large uncertainties exist in the shape and redshift evolution of both \SFRDz, and  \dpdZ (see e.g. \citealt{Chruslinska2019}, \citealt{Boco2021} and \citealt{Chruslinska+2021} for an extended discussion on the metallicity dependent star formation rate density, in light of empirical data).

To construct \SFRDzZ from empirical data, one can estimate \dpdZ by combining observed mass-metallicity relations with galaxy stellar mass functions \citep[see e.g.][]{Chruslinska+2018, Chruslinska2019, Broekgaarden+2021b}. Alternatively, one could extract \SFRDzZ directly from cosmological simulations \citep[e.g.][]{Mapelli2017, Briel+2021}. 

In this work, we take an approach similar to \citet{Mapelli2017} and \cite{Briel+2021}  but instead of directly extracting the \SFRDzZ from a cosmological simulation we fit analytical representations of \SFRDz and \dpdZ to simulation data.

By adopting an analytical, parametrized form for \SFRDzZ, the large uncertainties in \SFRDzZ can be systematically explored through smoothly varying the parameters that control its shape (cf.~\citealt{Briel+2021}). 




Different cosmological simulations produce varying \SFRDzZ which lead to different redshift evolution of the BBH merger rate with redshift. \cite{Briel+2021} find that the EAGLE and TNG simulation provide the best \SFRDzZ based on the predicted cosmic rates for electromagnetic and gravitational-wave transients. 
Although we only consider our fit to describe the IllustrisTNG100 simulation and the phenomenological fit from \cite{Neijssel+2019}, our prescription can be easily be updated to fit other observational or simulated data of the metallicity dependent star formation rate density.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Illustris-TNG Cosmological simulations}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The IllustrisTNG-project considers galaxy formation and evolution through large-scale cosmological hydrodynamical simulations.

\SdM{Insert a description of enrichment and gas recycling. }

They have been shown to reproduce many of the global properties of galaxies and their scaling relations for a representative portion of the Universe \citep[e.g.][]{FirstResTNG_Naiman2018,Torrey+2021,Genel+2018,Hemler+2021}.These simulations are publicly available\footnote{ \url{https://www.tng-project.org/}} \citep{FirstResTNG_Springel2018,FirstResTNG_Marinacci2018, FirstResTNG_Nelson2018,FirstResTNG_Pillepich2018, FirstResTNG_Naiman2018}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{A convenient analytic expression for the metallicity-dependent star formation rate density}
\label{sec: SFRD}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{s: fitting SFRD}
We assume that the metallicity dependent star formation rate density can be separated into two independent functions \citep[e.g.\ ][]{Langer2006},

\begin{equation}
\label{eq: SFRD1}
    \SFRDzZ = \SFRDz \times \dPdZ.
\end{equation}
The first term is the star formation rate density, \SFRDz, that is the amount of mass formed in stars per unit time and per unit comoving volume at each redshift. The second term, \dpdZ, is a probability density function that expresses what fraction of star formation occurs at which metallicity, at each redshift. 
 


%% SFR(z) %%


% $a=0.02$, $b=1.48$, $c=4.45$ and $d=5.9$ as best fitting parameters,
\subsection{The metallicity probability density function}
For the probability distribution of metallicities we draw inspiration from the approach by \citep[e.g.\ ][]{Neijssel+2019} who used a log-normal distribution. Unfortunately, this expression does not capture the asymmetry well that we see in the results of the cosmological simulations, which show an extended tail towards low metallicity combined with a very limited tail towards higher metallicity, when plotted as a function of $\log_10 Z$. To capture this behavior we adopt a skewed-log-normal distribution instead. This is an extension of the normal distribution that introduces an additional shape parameter, $\alpha$, that regulates the skewness \citep{Ohagan+1976}. This allows us to more accurately capture the asymmetry in the metallicity distribution at each redshift.

The skewed-log-normal distribution of metallicities is defined as:

\begin{equation}
\begin{aligned}
\label{eq: pure log skew}
\mathrm{\frac{dP}{dZ}}(Z) &= \frac{1}{Z} \times \frac{\rm dP}{{\rm d}\ln Z}  \\
&= \frac{2}{Z} \times
    \underbrace { \phi \left(\frac{\ln Z - \xi}{\omega}\right)
                 }_{(1)}
    \underbrace {
                \Phi\left(\alpha \frac{\ln Z - \xi}{\omega} \right)
                }_{(2)},
\end{aligned}
\end{equation}


\noindent where (1) is the standard log-normal distribution, $\phi$,
%
\begin{equation}
\label{eq: log normal and CDF}
 \phi \left(\frac{\ln Z - \xi}{\omega}\right) \equiv 
% \underbrace{
    \frac{1}{\omega \sqrt{2 \pi}} 
    \exp{
         \left\{
            -\frac{1}{2} \left(\frac{\ln Z - \xi}{\omega}\right)^2
        \right\}
        }
  %  }_{(1)} 
    \end{equation}
and (2) is the new term that allows for asymmetry, which is equal to the cumulative of the log-normal distribution, $\Phi$,
    \begin{equation}
    \begin{array}{cc}
 \Phi\left(\alpha \frac{\ln Z - \xi}{\omega} \right) &\equiv 
% \underbrace {
    \frac{1}{2} 
    \left( 
        1 + {\rm erf}
            \left\{
%                \frac{ \left(\alpha \frac{\ln(Z) - \xi}{\omega} \right)  }{\sqrt{2}} 
                \alpha \frac{\ln Z - \xi}{\omega \sqrt{2}}
            \right\} 
    \right) \\
    %}_{(2)}.
  &=    \frac{1}{2} 
       \int_{\infty}^{\alpha\left( \frac{\ln Z -\xi}{\omega}\right)}
       \frac{1}{\sqrt{2\pi}}e^{-t^2/2}dt
    \end{array}
\end{equation}

%
\noindent This introduces three parameters, $\alpha, \omega$ and $\xi$ each of which may depend on redshift. The first parameter, $\alpha$, is known as the ``shape''. It affects the skewness of the distribution and thus allows for asymmetries between metallicities that are higher and lower than the mean.  The symmetric log-normal distribution is recovered for $\alpha=0$. The second parameter, $\omega$  is known as the ``scale''. It provides a measure of the spread in metallicities at each redshift.   Finally, $\xi$, is known as the ``location'', because this parameter plays a role in setting the mean of the distribution at each redshift.

\paragraph{The location and the mean of the metallicity distribution}
To obtain a useful expression for the redshift dependence of the ``location'' $\xi(z)$ we first express the expectation value or mean metallicity at a given redshift

\begin{equation}
 \langle  Z \rangle 
 = 2 \exp
        \left( \frac{\xi\,\omega^2}{2} \right)
         \Phi\left(\beta\, \omega\right)
 \label{eqn:Zmean}
\end{equation}
where $\beta$ is 
\begin{equation}
\label{eq: beta}
\beta = \frac{\alpha}{\sqrt{1 + \alpha^2} }.
\end{equation}

\noindent For the evolution of the mean metallicity with redshift we follow \cite{Neijssel+2019} and \cite{Langer2006} in assuming that the mean of the probability density function of metallicities evolves with redshift as:
\begin{equation}
\label{eq: mean Z}
    \langle Z \rangle \equiv \mu(z) = \mu_0 \cdot 10^{\mu_z \cdot z},
\end{equation}
where $\mu_0
%= 0.025 
$ is the mean metallicity at redshift 0, and $\mu_z
%= -0.048
$ determines redshift evolution of the location. Equating this to Equation~\ref{eqn:Zmean}, we get an expression for $\xi(z)$,

\begin{equation}
\label{eq mu z}
    \xi(z) = -\frac{\omega^2}{2}\, \ln\left(\frac{  \mu_0 \cdot 10^{\mu_z \cdot z} }{2\, \Phi(\beta\, \omega)}  \right).
\end{equation}

\paragraph{The scale (and variance) of the metallicity distribution}

We will also allow the ``scale'' $w$ also evolves with redshift in a similar manner, 
\begin{equation}
\label{eq: sigma z}
    \omega(z) = \omega_0 \cdot 10^{\omega_z \cdot z}.
\end{equation}
where $\omega_0$ is
%$\omega_0 = 1.125$, 
the width of the metallicity distribution at $z=0$, and $\omega_z$
%$\omega_z = 0.048$, 
the redshift evolution of the scale.

Note that the width, $w(z)$ is not the same as the variance. The variance, $\sigma(z)^2$, can be expressed as

\begin{equation}
    \sigma(z)^2 = \omega(z)^2 \left( 1 - \frac{2\beta^2}{\pi} \right)
\end{equation}

\paragraph{Assymetry of the metallicity distribution: $\alpha$}
We have considered variations where the ``skewness'' $\alpha$ varies with redshift but we did not find very significant improvements compared to the simpler assumption where $\alpha$ is kept constant. 


%We allow the mean metallicity and the spread of metallicities to evolve with redshift by allowing the ``location'' $\xi(z)$ and ``scale'' $\omega(z)$ to vary as functions of redshift. We have also considered to allow the ``skewness'' to vary with redshift, but we did not find a very significant improvement and we opted to keep this constant. 

In summary, Equation~\ref{eq: pure log skew} becomes:
\begin{equation}
\label{eq: z log skew}
\mathrm{\frac{dP}{dZ}}(Z,z) = \frac{2}{Z} \times \phi \left(\frac{\ln Z - \xi(z)}{\omega(z)}\right) \Phi\left(\alpha \frac{\ln Z - \xi(z)}{\omega(z)} \right),
\end{equation}

\noindent where $\xi(z)$ and $\omega(z)$ are defined in Equations~\ref{eq mu z} and \ref{eq: sigma z} respectively and we have assumed $\alpha$ to be constant.

%, and our fit value for $\alpha = -1.77$. Our set of parameters for \dpdZ is thus:  $\mu_0 = 0.025, \mu_z = -0.048, \sigma_0 = 1.125, \sigma_z = 0.048$ and $\alpha = -1.77$.

\subsection{The overall cosmic star formation rate density}
For the star formation rate density, we assume the analytical form proposed by \cite{MadauDickinson2014},
\begin{eqnarray}
\label{eq: sfr1}
    \SFRDz  = 
    \frac{d^2 M_{\rm SFR}}{dt dV_c} (z)= 
    a \frac{\left(1 + z\right)^b}{1 + \left[ (1 + z)/c \right]^d} \,
\end{eqnarray}
in units of $\left[ \Msun \,yr^{-1} \,cMpc^{-3} \right]$. This introduces four parameters, $a$ which sets the overal normalisation and which has the same units as \SFRDz and $b,c$ and $d$ which are unitless and which govern the shape of the overal cosmic starformation rate density with redshift.   

\subsection{Combined function}
We combine equations \ref{eq: z log skew} and \ref{eq: sfr1} to form a full metallicity specific starformation rate density (\SFRDzZ). We fit for the following nine free parameters $\alpha, \mu_0, \mu_z, \omega_0, \omega_z$, which govern the metallicity dependence and $a,b, c$ and $d$, which set the overall starformation rate.


\section{Analytical fit against Cosmological simulation}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{figure*}
%\includegraphics[width=\textwidth]{figures/SFRD_FIT_evaluation_compare.pdf}
%\caption{Fit for SFRD shown against TNG and Neijssel.  \label{fig: fit SFRD}}
%\end{figure*}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
The task we have at hand here is not a standard textbook fitting problem given the specific aims and requirements that we have that are driven by the astrophysical applications we have in mind. Qualitatively, our aims are the following.  Our main aim is to find solution for the free parameters, for which the expression reproduces the overall behavior that is observed in the cosmological simulations. For the purposes we have in mind, it will be more important to prioritize fitting the large scale trends, while we are not so interested in smaller scale fluctuations. We further prioritize getting the bulk of the cosmic star formation right and are less interested in capturing the behavior in metallicity and redshift bins where the cosmic starformation rate is very low and thus insignificant for the overall picture. Finally, we are especially interested in capturing the asymmetry of the metallicity distribution. 

There is not one unique procedure that will full fill these criteria.  After experimenting with different criteria we have adopted the procedure below, which we believe works well for the aims we have in mind.  

\subsection{Choices and binning of the data}

We fit our function to the metallicity distribution of the starforming gas in the TNG100 simulation. For this we use a binned version of the TNG data $\SFRDzZ_{\rm sim}$. We consider metallicities between $Z= -5$ to $\log_{10} Z= 0$ in 30 bins, where we use $Z_i$ to refer to the logarithmic centers of the bins. We ignore star formation in metallicities $\log_{10} Z \le -5$ as this only accounts for less than 1\% of the total cosmic starformation rate in these simulations.  

We consider bins in redshifts between $z=0$ and $z=10$, with a step size of $dz=0.05$, where $z_j$ refers to the centers of the bins. 

\subsection{Optimization function}

To find a solution we use a method based on the sum of the quadratic differences between the simulations and our fit function. Using a vanilla $\chi$-squared approach does not serve our purposes very well as it does a poor job in fitting regions where the starformation is very low.  Using a $\chi$-squared approach on the logarithm of the function instead places far too much weight on trying to fit the starformation rate in regions where the rate is very low or not even significant.  After experimenting, we find that the following approach gives us satisfactory results. 

We first consider a given redshift $z_j$.  For this redshift we compute the sum of the squared residuals between the cosmological simulation and our fit.  
%
\begin{equation}
\label{eq: chisquare}
    \chi^2 (z_j) \equiv \sum_{Z_i} \left( 
        \mathcal{S}(Z_i,z_j)_{\rm sim} - 
        \mathcal{S}(Z_i,z_j)_{\rm fit}\right)^2
    %chi_square = ((obs - model )**2)/np.sum(model) 
\end{equation}
%
Here, the variable $Z_i$ runs over all redshift bins, but excludes bins where the starformation rate density is lower $10^{-10} \Msun \yr \Mpc^{-3}$ per bin. 

Subsequently we sum the $\chi^2 (z_j)$ for all redshift bins $z_j$. To ensure that our fit procedure gives sufficient weight to the behavior at all redshifts, we find that we need to introduce a penalization factor to somewhat reduce the contribution of redshifts where the peak of cosmic starformation occurs, while increasing the weight where at redshifts where the overal cosmic starformation rate is lower.  To achive this we divide $\chi^2 (z_j)$ by the starformation $\sum_{Z_i} \mathcal{S}(Z_i,z_j)$ per redshift bin before adding the contribution of all redshifts.  Our final expression for the cost function reads

\begin{equation}
\label{eq: chisquare}
    \chi  = \sum_{z_j} \frac{ \chi^2 (z_j) } 
        {\sum_{Z_i} \mathcal{S}(Z_i,z_j)}
    %chi_square = ((obs - model )**2)/np.sum(model) 
\end{equation}


We use the \texttt{scipy.optimize.minimize} 
from SciPy v1.6.3 implementation of the optimized quasi-Newton method of Broyden, Fletcher, Goldfarb, and Shanno (BFGS) \url{http://www.apmath.spbu.ru/cnsa/pdf/monograf/Numerical_Optimization2006.pdf}




With the fit parameters as mentioned above, we find a maximum residual between the model and the TNG100 data of $2.3\cdot 10^{-3} \Msun \yr^{-1} \Mpc^{-3}$ at any given redshift.




Our best fitting parameters are listed in Table \ref{tab: fit params}. With these fit parameters, $\chi^2(z_j)$ is smaller than $2\cdot 10^{-4}$ at any given redshift.

\begin{deluxetable}{cccc}
\label{tab: fit params}
\tablecaption{Best fitting parameters for our \SFRDzZ fit to TNG100 data.}
\tablehead{\colhead{dP/dZ param.} & \colhead{best fit} & \colhead{SFRD(z) param.} & \colhead{best fit} } 
%% All data must appear between the \startdata and \enddata commands
\startdata
$\mu_0$ &  0.025 &  $a$ &  0.02 \\
$\mu_z$ &  -0.048 &  $b$ &  1.48 \\
$\alpha_0$ &  -1.767 &  $c$ &  4.45 \\
$\sigma_0$  & 1.125       &  $d$ &  5.90 \\
$\sigma_z$ &  0.048 &   \\
\enddata
%sf_a_best, sf_b_best, sf_c_best,  sf_d_best = 0.02, 1.48, 4.45, 5.90
% sf_a =0.01687063881834458, sf_b =1.4834054063851878, sf_c =4.448574027958166, sf_d =5.903964702985274

%muz =-0.048, mu0 =0.025, sigma_0 =1.125, sigma_z =0.048, alpha=-1.767
% muz =-0.048244647721407255, mu0 =0.024667742078400792, sigma_0 =1.1253850972905333, sigma_z =0.048072863682492945, alpha=-1.7671626767422142
\end{deluxetable}





\bibliography{my_bib,main_bib}


\end{document}
